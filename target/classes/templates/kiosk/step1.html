<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>äº‹å‰ç²¾ç®—ï½œãƒŠãƒ³ãƒãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆå…¥åŠ›</title>
<style>
:root {
	--bg: #fdf5e6; /* ë°ì€ ë² ì´ì§€ */
	--panel: #fffaf0; /* ì¹´ë“œ/íŒ¨ë„ */
	--text: #444; /* ì–´ë‘ìš´ í…ìŠ¤íŠ¸ */
	--line: #d8c49b;
	--accent: #d6b85a; /* ê°•ì¡° ìƒ‰ìƒ */
	--muted: #666;
	--hover: #f8efd0;
}

* {
	box-sizing: border-box;
}

html, body {
	height: 100%;
	margin: 0;
	padding: 0;
}

body {
	background: var(--bg);
	color: var(--text);
	font-family: 'Noto Sans JP', 'Malgun Gothic', sans-serif;
	display: flex;
	flex-direction: column;
}

/* ìƒë‹¨ë°” */
.topbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 12px 20px;
	background: var(--panel);
	border-bottom: 2px solid var(--line);
}

.title {
	font-weight: 800;
	text-align: center;
	flex: 1;
}

.actions {
	display: flex;
	gap: 10px;
}

/* ë²„íŠ¼ (í™ˆ, English í¬í•¨) */
.link-btn, .btn, .btn-aux {
	border: 2px solid var(--line);
	border-radius: 10px;
	background: var(--bg);
	color: var(--text);
	font-weight: 700;
	cursor: pointer;
	transition: background .2s ease, transform .05s ease;
}

.link-btn:hover, .btn:hover, .btn-aux:hover {
	background: var(--hover);
}

.link-btn {
	padding: 8px 12px;
	font-size: 13px;
}

.btn {
	padding: 12px 0;
	font-size: 26px;
}

.btn-aux {
	font-size: 20px;
	padding: 10px 0;
}

.btn:active, .btn-aux:active {
	transform: translateY(1px);
}

.btn-cancel, .btn-confirm {
	background: var(--bg);
}

/* ë³¸ë¬¸ */
.wrap {
	flex: 1;
	display: grid;
	gap: 16px;
	padding: 16px;
	grid-template-columns: 1.25fr 0.75fr;
}

@media ( max-width :980px) {
	.wrap {
		grid-template-columns: 1fr;
	}
}

.card {
	background: var(--panel);
	border-radius: 12px;
	border: 1px solid var(--line);
	padding: 20px;
}

/* ë²ˆí˜¸íŒ */
.plate-area {
	display: grid;
	gap: 18px;
	align-items: center;
	justify-items: center;
}

.plate-frame {
	background: #fff;
	color: #222;
	width: min(98%, 980px);
	border: 8px solid var(--line);
	border-radius: 16px;
	padding: 22px;
}

.seg {
	display: flex;
	align-items: center;
	gap: 10px;
}

.seg label {
	color: #b91c1c;
	font-weight: 900;
}

.select {
	font-size: 24px;
	font-weight: 900;
	border: 2px solid var(--line);
	border-radius: 10px;
	background: #fff;
	color: #222;
	padding: 6px 10px;
}

.box {
	background: #fff;
	border: 2px solid var(--line);
	border-radius: 10px;
	font-weight: 900;
	font-size: 32px;
	min-width: 140px;
	min-height: 64px;
	display: flex;
	align-items: center;
	justify-content: center;
}

.box.focus {
	outline: 3px solid var(--accent);
	outline-offset: 2px;
}

.hint {
	text-align: center;
	color: var(--muted);
	font-size: 13px;
	margin-top: 8px;
}

/* í‚¤íŒ¨ë“œ */
.keypad {
	display: grid;
	grid-template-rows: auto 1fr auto;
	gap: 12px;
	min-height: 520px;
}

.grid {
	display: grid;
	grid-template-columns: repeat(3, 1fr);
	grid-auto-rows: 90px;
	gap: 12px;
}

.pad-title {
	text-align: center;
	font-weight: 700;
}
</style>
</head>
<body>
	<!-- ìƒë‹¨ë°” -->
	<div class="topbar">
		<div class="actions">
			<a href="/kiosk/step1" class="link-btn" id="btnHome">ğŸ  ãƒ›ãƒ¼ãƒ </a>
		</div>
		<div class="title" id="titleText">ãƒŠãƒ³ãƒãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
		<div class="actions">
			<button type="button" class="link-btn" id="btnLang">English</button>
		</div>
	</div>

	<!-- ë³¸ë¬¸ -->
	<main class="wrap">
		<!-- ì™¼ìª½ ë²ˆí˜¸íŒ -->
		<section class="card plate-area">
			<div class="plate-frame">
				<div class="seg">
					<label>â‘ </label> <select id="regionSelect" class="select">
						<option>å“å·</option>
						<option>æ¨ªæµœ</option>
						<option>å¤§å®®</option>
						<option>è¶³ç«‹</option>
						<option>å¤šæ‘©</option>
					</select> <label>â‘¡</label>
					<div id="classBox" class="box">___</div>
				</div>
				<div class="seg" style="margin-top: 12px;">
					<label>â‘¢</label> <select id="kanaSelect" class="select"
						style="min-width: 100px;">
						<option>ã‚</option>
						<option>ã„</option>
						<option>ã†</option>
						<option>ãˆ</option>
						<option>ãŠ</option>
					</select> <label>â‘£</label>
					<div id="serialBox" class="box" style="min-width: 200px;">__-__</div>
				</div>
			</div>
			<div class="hint" id="leftHint">ãƒ†ãƒ³ã‚­ãƒ¼ã¯â‘¡(3æ¡) â†’
				â‘£(4æ¡)ã®é †ã«å…¥åŠ›ã—ã¾ã™ã€‚ï¼ˆå–æ¶ˆï¼å…¨æ¶ˆå»ï¼‰</div>
		</section>

		<!-- ì˜¤ë¥¸ìª½ í‚¤íŒ¨ë“œ -->
		<aside class="card keypad">
			<div class="pad-title" id="padTitle">ãƒ†ãƒ³ã‚­ãƒ¼</div>
			<div class="grid">
				<button class="btn" data-digit="1">1</button>
				<button class="btn" data-digit="2">2</button>
				<button class="btn" data-digit="3">3</button>
				<button class="btn" data-digit="4">4</button>
				<button class="btn" data-digit="5">5</button>
				<button class="btn" data-digit="6">6</button>
				<button class="btn" data-digit="7">7</button>
				<button class="btn" data-digit="8">8</button>
				<button class="btn" data-digit="9">9</button>
				<div></div>
				<button class="btn" data-digit="0">0</button>
				<div></div>
			</div>

			<div class="grid">
				<button id="btnCancel" class="btn-aux btn-cancel">å–æ¶ˆ</button>
				<div></div>
				<button id="btnConfirm" class="btn-aux btn-confirm" disabled>ç¢ºå®š</button>
			</div>
			<div class="hint" id="padHint">â€»ã€Œ0ã€ãƒœã‚¿ãƒ³ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚ä¸¡æ–¹ã®æ¬„ã‚’åŸ‹ã‚ã‚‹ã¨ç¢ºå®šã§ãã¾ã™ã€‚</div>
		</aside>
	</main>

	<form id="nextForm" action="/kiosk/step2" method="get"
		style="display: none">
		<input type="hidden" name="plate" id="plateValue">
	</form>

	<script>
(function(){
  let active='class', c3='', s4='', lang=localStorage.getItem('kiosk_lang')||'ja';
  const cBox=document.getElementById('classBox'), sBox=document.getElementById('serialBox');
  const region=document.getElementById('regionSelect'), kana=document.getElementById('kanaSelect');
  const btnC=document.getElementById('btnCancel'), btnF=document.getElementById('btnConfirm');
  const form=document.getElementById('nextForm'), val=document.getElementById('plateValue');
  const tText=document.getElementById('titleText'), pTitle=document.getElementById('padTitle');
  const pHint=document.getElementById('padHint'), lHint=document.getElementById('leftHint');
  const bLang=document.getElementById('btnLang'), bHome=document.getElementById('btnHome');

  const i18n={
    ja:{title:"ãƒŠãƒ³ãƒãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",padTitle:"ãƒ†ãƒ³ã‚­ãƒ¼",padHint:"â€»ã€Œ0ã€ãƒœã‚¿ãƒ³ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚ä¸¡æ–¹ã®æ¬„ã‚’åŸ‹ã‚ã‚‹ã¨ç¢ºå®šã§ãã¾ã™ã€‚",
      leftHint:"ãƒ†ãƒ³ã‚­ãƒ¼ã¯â‘¡(3æ¡) â†’ â‘£(4æ¡)ã®é †ã«å…¥åŠ›ã—ã¾ã™ã€‚ï¼ˆå–æ¶ˆï¼å…¨æ¶ˆå»ï¼‰",cancel:"å–æ¶ˆ",confirm:"ç¢ºå®š",home:"ãƒ›ãƒ¼ãƒ ",langToggle:"English",
      alert:"åˆ†é¡ç•ªå·(3æ¡)ã¨ä¸€é€£ç•ªå·(4æ¡)ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"},
    en:{title:"Please enter your license plate number.",padTitle:"Number Pad",padHint:"â€» '0' is available. You can confirm when both fields are complete.",
      leftHint:"Enter â‘¡ (3 digits) then â‘£ (4 digits). (Cancel = Clear all)",cancel:"Clear",confirm:"Confirm",home:"Home",langToggle:"æ—¥æœ¬èª",
      alert:"Please enter Class No. (3 digits) and Serial (4 digits)."}
  };
  function setLang(){
    const t=i18n[lang];
    tText.textContent=t.title; pTitle.textContent=t.padTitle;
    pHint.textContent=t.padHint; lHint.textContent=t.leftHint;
    btnC.textContent=t.cancel; btnF.textContent=t.confirm;
    bHome.textContent=t.home; bLang.textContent=t.langToggle;
  }
  bLang.onclick=()=>{ lang=(lang==='ja'?'en':'ja'); localStorage.setItem('kiosk_lang',lang); setLang(); };

  const fC=()=> (c3+"___").slice(0,3).replace(/ /g,'_');
  const fS=()=>{const d=(s4+"____").slice(0,4);return d.slice(0,2).replace(/ /g,'_')+"-"+d.slice(2).replace(/ /g,'_');};
  const update=()=>{cBox.textContent=fC(); sBox.textContent=fS(); cBox.classList.toggle('focus',active==='class');
    sBox.classList.toggle('focus',active==='serial'); btnF.disabled=!(c3.length===3&&s4.length===4);}
  const add=n=>{ if(active==='class'){if(c3.length<3){c3+=n;if(c3.length===3)active='serial';}}
    else if(s4.length<4){s4+=n;} update(); }
  const clear=()=>{c3='';s4='';active='class';update();}

  document.querySelectorAll('[data-digit]').forEach(b=>b.onclick=()=>add(b.getAttribute('data-digit')));
  btnC.onclick=clear;
  btnF.onclick=()=>{if(!(c3.length===3&&s4.length===4)){alert(i18n[lang].alert);return;}
    val.value=`${region.value} ${fC()} ${kana.value} ${fS()}`;form.submit();}
  setLang(); update();
})();
</script>
</body>
</html>
