<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>äº‹å‰ç²¾ç®—ï½œã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³æ¥ç¶šä¸­</title>
<style>
:root {
	--bg: #fdf5e6;
	--panel: #fffaf0;
	--text: #444;
	--line: #d8c49b;
	--accent: #d6b85a;
	--muted: #666
}

* {
	box-sizing: border-box
}

html, body {
	height: 100%;
	margin: 0;
	padding: 0
}

body {
	background: var(--bg);
	color: var(--text);
	font-family: 'Noto Sans JP', 'Malgun Gothic', sans-serif;
	display: flex;
	flex-direction: column
}

.topbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 12px 20px;
	background: var(--panel);
	border-bottom: 2px solid var(--line)
}

.title {
	font-weight: 800;
	text-align: center;
	flex: 1
}

.actions, .actions-left {
	display: flex;
	gap: 10px;
	align-items: center
}

.link-btn {
	border: 2px solid var(--line);
	border-radius: 10px;
	background: var(--bg);
	color: var(--text);
	font-weight: 700;
	padding: 8px 12px;
	font-size: 13px;
	cursor: pointer
}

.main {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	padding: 24px;
	text-align: center
}

.h1 {
	font-weight: 900;
	font-size: clamp(22px, 3.2vw, 36px);
	margin: 0 0 12px
}

.p {
	font-size: clamp(16px, 2vw, 20px);
	color: var(--muted);
	margin: 0 0 18px
}

.p-2 {
	font-size: clamp(16px, 2vw, 20px);
	margin: 0
}

.spinner {
	width: 56px;
	height: 56px;
	border-radius: 50%;
	border: 6px solid #e9dfc5;
	border-top-color: var(--accent);
	animation: spin 1s linear infinite;
	margin: 18px auto
}

@keyframes spin {
	to {transform: rotate(360deg)
}
}
</style>
</head>
<body>
	<div class="topbar">
		<div class="actions-left">
			<a href="/kiosk/step1" class="link-btn" id="btnHome">ğŸ  ãƒ›ãƒ¼ãƒ </a>
			<!-- ëŒì•„ê°€ê¸°: í•­ìƒ "ì´ì „ì˜ ì¸í„°í° ì—°ê²° ë²„íŠ¼ í˜ì´ì§€"ë¡œ ë³µê·€ -->
			<a href="javascript:void(0)" class="link-btn" id="btnBack">â† æˆ»ã‚‹</a>
		</div>
		<div class="title" id="titleText">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³æ¥ç¶š</div>
		<div class="actions">
			<button type="button" class="link-btn" id="btnLang">English</button>
		</div>
	</div>

	<div class="main">
		<div class="spinner" id="spinner"></div>
		<div class="h1" id="heading">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã«æ¥ç¶šã—ã¦ã„ã¾ã™â€¦</div>
		<div class="p" id="sub1">ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚</div>
		<div class="p-2" id="sub2" style="display: none;">æ¥ç¶šã•ã‚Œã¾ã—ãŸã€‚ä¿‚å“¡ãŒå¿œç­”ã„ãŸã—ã¾ã™ã€‚</div>
	</div>

	<script>
  (function(){
    let lang = localStorage.getItem('kiosk_lang') || 'ja';
    const tTitle=document.getElementById('titleText');
    const bLang=document.getElementById('btnLang');
    const home=document.getElementById('btnHome');
    const back=document.getElementById('btnBack');
    const h=document.getElementById('heading'), s1=document.getElementById('sub1'), s2=document.getElementById('sub2');

    const i18n = {
      ja:{title:"ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³æ¥ç¶š", home:"ãƒ›ãƒ¼ãƒ ", back:"â† æˆ»ã‚‹", lang:"English",
          h:"ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã«æ¥ç¶šã—ã¦ã„ã¾ã™â€¦", s1:"ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚", s2:"æ¥ç¶šã•ã‚Œã¾ã—ãŸã€‚ä¿‚å“¡ãŒå¿œç­”ã„ãŸã—ã¾ã™ã€‚"},
      en:{title:"Intercom", home:"Home", back:"â† Back", lang:"æ—¥æœ¬èª",
          h:"Connecting to intercomâ€¦", s1:"Please wait a moment.", s2:"Connected. An attendant will assist you shortly."}
    };

    function applyLang(){
      const t=i18n[lang];
      tTitle.textContent=t.title; home.textContent=t.home; back.textContent=t.back; bLang.textContent=t.lang;
      h.textContent=t.h; s1.textContent=t.s1; s2.textContent=t.s2;
    }

    if(bLang){
      bLang.onclick=()=>{ lang=(lang==='ja'?'en':'ja'); localStorage.setItem('kiosk_lang',lang); applyLang(); };
    }

    // âœ… â† ëŒì•„ê°€ê¸°: ê°€ì¥ ë¨¼ì € 'ë°”ë¡œ ì „ í˜ì´ì§€'ë¡œ(plate íŒŒë¼ë¯¸í„° ìœ ì§€),
    //    ì—†ìœ¼ë©´ sessionStorageì˜ plateë¡œ step2 ë³µêµ¬, ê·¸ë˜ë„ ì—†ìœ¼ë©´ step1.
    back.onclick = () => {
      if (document.referrer && /\/kiosk\/step2\b/.test(document.referrer) && history.length > 1) {
        history.back();
        return;
      }
      const plate = sessionStorage.getItem('plate');
      if (plate) {
        window.location.href = '/kiosk/step2?plate=' + encodeURIComponent(plate);
      } else {
        window.location.href = '/kiosk/step1';
      }
    };

    // 2.5ì´ˆ í›„ ì—°ê²° ë©”ì‹œì§€ ë…¸ì¶œ
    setTimeout(()=>{ s2.style.display='block'; }, 2500);

    applyLang();
  })();
  </script>
</body>
</html>
