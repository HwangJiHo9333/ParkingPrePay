<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>äº‹å‰ç²¾ç®—ï½œè»Šä¸¡ç¢ºèª</title>
<style>
:root {
	--bg: #fdf5e6;
	--panel: #fffaf0;
	--text: #444;
	--line: #d8c49b;
	--accent: #d6b85a;
	--hover: #f8efd0;
	--muted: #666;
}

* {
	box-sizing: border-box
}

html, body {
	height: 100%;
	margin: 0;
	padding: 0
}

body {
	background: var(--bg);
	color: var(--text);
	font-family: 'Noto Sans JP', 'Malgun Gothic', sans-serif;
	display: flex;
	flex-direction: column
}

/* Topbar */
.topbar {
	display: flex;
	justify-content: space-between;
	align-items: center;
	padding: 12px 20px;
	background: var(--panel);
	border-bottom: 2px solid var(--line)
}

.title {
	font-weight: 800;
	text-align: center;
	flex: 1
}

.actions, .actions-left {
	display: flex;
	gap: 10px;
	align-items: center
}

.link-btn, .k-btn {
	border: 2px solid var(--line);
	border-radius: 10px;
	background: var(--bg);
	color: var(--text);
	font-weight: 700;
	cursor: pointer;
	transition: background .2s ease, transform .05s ease
}

.link-btn:hover, .k-btn:hover {
	background: var(--hover)
}

.link-btn {
	padding: 10px 14px;
	font-size: 15px
}

.k-btn {
	padding: 16px 36px;
	font-size: 20px
}

.k-btn:active {
	transform: translateY(1px)
}

/* Main */
.main-wrap {
	flex: 1;
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: flex-start;
	padding: 24px
}

h2 {
	margin: 0 0 16px
}

.center-title {
	text-align: center
}

/* â”€â”€ ì—¬ëŸ¬ëŒ€(2+) â”€â”€ */
.card-grid {
	display: grid;
	grid-template-columns: repeat(2, minmax(360px, 1fr));
	gap: 32px;
	width: 100%;
	max-width: 1180px;
	margin-top: 16px
}

.card {
	width: 100%;
	background: var(--panel);
	border: 2px solid var(--line);
	border-radius: 16px;
	text-align: center;
	box-shadow: 0 4px 10px rgba(0, 0, 0, .1);
	transition: transform .1s ease, background .2s ease
}

.card:hover {
	transform: translateY(-3px);
	background: var(--hover)
}

.thumb img {
	width: 100%;
	height: 240px;
	object-fit: cover;
	border-radius: 14px 14px 0 0
}

.info {
	padding: 14px 12px 6px
}

.info h3 {
	margin: 6px 0 4px;
	font-size: 22px
}

.info .muted {
	color: var(--muted);
	font-size: 15px
}

.card .cta {
	padding: 18px 16px 22px
}

/* â”€â”€ í•œëŒ€(1) â”€â”€ */
.single-wrap {
	width: 100%;
	max-width: 900px;
	margin-top: 16px;
	display: flex;
	flex-direction: column;
	align-items: center
}

.card-large {
	width: 100%;
	background: var(--panel);
	border: 3px solid var(--line);
	border-radius: 20px;
	text-align: center;
	box-shadow: 0 8px 18px rgba(0, 0, 0, .12);
	transition: transform .1s ease, background .2s ease
}

.card-large:hover {
	transform: translateY(-2px);
	background: var(--hover)
}

.card-large .thumb img {
	width: 100%;
	height: 360px;
	object-fit: cover;
	border-radius: 18px 18px 0 0
}

.card-large .info {
	padding: 18px 16px 8px
}

.card-large .info h3 {
	margin: 8px 0 6px;
	font-size: 26px
}

.card-large .info .muted {
	font-size: 16px;
	color: var(--muted)
}

.card-large .cta {
	padding: 20px 18px 24px
}

.card-large .k-btn {
	padding: 18px 42px;
	font-size: 22px
}

/* â”€â”€ ì—†ìŒ(0) : íˆì–´ë¡œí˜• í¬ê²Œ â”€â”€ */
.empty-hero {
	width: 100%;
	max-width: 1280px;
	min-height: clamp(520px, 70vh, 820px);
	display: grid;
	grid-template-rows: auto 1fr auto;
	align-items: center;
	justify-items: center;
	gap: 18px;
	margin-top: 8px;
}

.empty-title {
	text-align: center;
	font-weight: 900;
	/* ë” í¬ê²Œ */
	font-size: clamp(26px, 3.4vw, 40px);
	margin: 0;
}

.call-panel {
	width: min(100%, 1100px);
	background: var(--panel);
	border: 4px solid var(--line);
	border-radius: 22px;
	padding: clamp(18px, 3vw, 32px);
	box-shadow: 0 10px 24px rgba(0, 0, 0, .12);
}

.call-list {
	display: grid;
	grid-template-columns: 1fr;
	gap: clamp(12px, 2.2vw, 20px);
	margin-top: 10px;
}

.call-item {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 16px;
	border: 3px dashed var(--line);
	border-radius: 16px;
	background: #fff;
	padding: clamp(14px, 2.4vw, 22px);
}

.call-label {
	font-weight: 900;
	font-size: clamp(20px, 2.2vw, 28px);
}

.call-value {
	font-weight: 900;
	font-size: clamp(22px, 2.6vw, 32px);
	color: #222;
	letter-spacing: .02em;
}

.call-value::before {
	content: "ï¼ˆ";
}

.call-value::after {
	content: "ï¼‰";
}

.call-help {
	margin-top: clamp(10px, 1.6vw, 16px);
	color: var(--muted);
	text-align: center;
	font-size: clamp(14px, 1.4vw, 18px);
}

/* ë²„íŠ¼ì„ ë” í¬ê²Œ, ëˆˆì— ë„ê²Œ */
.intercom-cta {
	display: flex;
	justify-content: center;
	margin-top: clamp(14px, 2vw, 22px)
}

.intercom-btn {
	border: 0;
	background: var(--accent);
	color: #222;
	font-weight: 900;
	border-radius: 16px;
	padding: clamp(16px, 2.6vw, 28px) clamp(28px, 4vw, 44px);
	font-size: clamp(20px, 2.4vw, 28px);
	box-shadow: 0 6px 16px rgba(0, 0, 0, .18);
	cursor: pointer;
}

.intercom-btn:hover {
	filter: brightness(1.03)
}

.intercom-btn:active {
	transform: translateY(1px)
}

/* Responsive */
@media ( max-width :960px) {
	.card-grid {
		grid-template-columns: 1fr;
		max-width: 560px
	}
	.single-wrap {
		max-width: 94%
	}
	.empty-hero {
		min-height: auto;
		padding-bottom: 8px;
	}
	.call-panel {
		width: 94%
	}
}
</style>
</head>
<body>
	<!-- Topbar -->
	<div class="topbar">
		<div class="actions-left">
			<a href="/kiosk/step1" class="link-btn" id="btnHome">ğŸ  ãƒ›ãƒ¼ãƒ </a> <a
				href="/kiosk/step1" class="link-btn" id="btnBack">â† æˆ»ã‚‹</a>
		</div>
		<div class="title" id="titleText">è»Šä¸¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</div>
		<div class="actions">
			<button type="button" class="link-btn" id="btnLang">English</button>
		</div>
	</div>

	<main class="main-wrap">
		<!-- 1ëŒ€ -->
		<div th:if="${candidates != null and #lists.size(candidates) == 1}"
			class="single-wrap" th:with="car=${candidates[0]}">
			<h2 id="subTitle" class="center-title">ä»¥ä¸‹ã®è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ</h2>
			<div class="card-large">
				<div class="thumb">
					<img
						th:src="${car.imageUrl != null ? car.imageUrl : '/images/noimage.png'}"
						alt="è»Šä¸¡ç”»åƒ">
				</div>
				<div class="info">
					<h3 th:text="${car.plate}">å“å· 300 ã‚ 12-34</h3>
					<div class="muted"
						th:text="${#temporals.format(car.entryAt,'yyyy-MM-dd HH:mm')}">2025-10-29
						13:20</div>
				</div>
				<div class="cta">
					<form th:action="@{/kiosk/step3}" method="get">
						<input type="hidden" name="carId" th:value="${car.id}">
						<button type="submit" class="k-btn" data-role="select">ã“ã®è»Šã‚’é¸æŠ</button>
					</form>
				</div>
			</div>
		</div>

		<!-- 2ëŒ€ ì´ìƒ -->
		<div th:if="${candidates != null and #lists.size(candidates) > 1}">
			<h2 id="subTitle" class="center-title">ä»¥ä¸‹ã®è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ</h2>
			<div class="card-grid">
				<div class="card" th:each="car,iter : ${candidates}"
					th:if="${iter.index} < 4">
					<div class="thumb">
						<img
							th:src="${car.imageUrl != null ? car.imageUrl : '/images/noimage.png'}"
							alt="è»Šä¸¡ç”»åƒ">
					</div>
					<div class="info">
						<h3 th:text="${car.plate}">å“å· 300 ã‚ 12-34</h3>
						<div class="muted"
							th:text="${#temporals.format(car.entryAt,'yyyy-MM-dd HH:mm')}">2025-10-29
							13:20</div>
					</div>
					<div class="cta">
						<form th:action="@{/kiosk/step3}" method="get">
							<input type="hidden" name="carId" th:value="${car.id}">
							<button type="submit" class="k-btn" data-role="select">ã“ã®è»Šã‚’é¸æŠ</button>
						</form>
					</div>
				</div>
			</div>
		</div>

		<!-- 0ëŒ€ : ì¸í„°í° ì—°ê²° í˜ì´ì§€ í¬ê²Œ -->
		<div th:if="${candidates != null and #lists.isEmpty(candidates)}"
			class="empty-hero">
			<h2 id="subTitle" class="empty-title">è©²å½“ã™ã‚‹è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h2>

			<div class="call-panel">
				<div class="call-list">
					<div class="call-item">
						<div class="call-label" id="labelCS">ãŠå®¢æ§˜ã‚»ãƒ³ã‚¿ãƒ¼</div>
						<div class="call-value" id="valCS">0120-123-456</div>
					</div>
					<div class="call-item">
						<div class="call-label" id="labelOffice">ç®¡ç†å®¤</div>
						<div class="call-value" id="valOffice">03-1234-5678</div>
					</div>
				</div>

				<div class="intercom-cta">
					<button class="intercom-btn" id="btnIntercom">è‡ªå‹•ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã«æ¥ç¶š</button>
				</div>

				<div class="call-help" id="helpMsg">â€»
					æ¥ç¶šãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æ¬¡ã®ç”»é¢ã«ã¦æ¥ç¶šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
			</div>
		</div>

		<!-- candidates == null -->
		<p th:if="${candidates == null}" class="center-title"
			style="margin-top: 20px; color: #666;">
			ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚</p>
	</main>

	<script>
  (function(){
    let lang = localStorage.getItem('kiosk_lang') || 'ja';
    const tText = document.getElementById('titleText');
    const sTitle = document.getElementById('subTitle');
    const bLang  = document.getElementById('btnLang');
    const bHome  = document.getElementById('btnHome');
    const bBack  = document.getElementById('btnBack');
    const btnInter = document.getElementById('btnIntercom');
    const labelCS = document.getElementById('labelCS');
    const labelOffice = document.getElementById('labelOffice');
    const helpMsg = document.getElementById('helpMsg');

    // step2 ë“¤ì–´ì˜¬ ë•Œ plateë¥¼ ì €ì¥í•´ ë‘ë©´ interphoneì—ì„œ ë³µê·€ì‹œ ì‚¬ìš© ê°€ëŠ¥
    const params = new URLSearchParams(location.search);
    const plate = params.get('plate');
    if (plate) sessionStorage.setItem('plate', plate);

    const i18n = {
      ja:{title:"è»Šä¸¡ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚", sub1:"ä»¥ä¸‹ã®è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ", sub0:"è©²å½“ã™ã‚‹è»Šä¸¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ",
          home:"ãƒ›ãƒ¼ãƒ ", back:"â† æˆ»ã‚‹", langToggle:"English", select:"ã“ã®è»Šã‚’é¸æŠ",
          cs:"ãŠå®¢æ§˜ã‚»ãƒ³ã‚¿ãƒ¼", office:"ç®¡ç†å®¤", inter:"è‡ªå‹•ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ›ãƒ³ã«æ¥ç¶š", help:"â€» æ¥ç¶šãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€æ¬¡ã®ç”»é¢ã«ã¦æ¥ç¶šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚"},
      en:{title:"Select your vehicle.", sub1:"The following vehicles were found:", sub0:"No matching vehicles were found.",
          home:"Home", back:"â† Back", langToggle:"æ—¥æœ¬èª", select:"Select this car",
          cs:"Customer Center", office:"Parking Office", inter:"Connect to Intercom Automatically", help:"* After pressing, you'll see a connection message on the next screen."}
    };

    function applyLang(){
      const t = i18n[lang];
      tText.textContent = t.title;
      if (sTitle) {
        const isEmptyView = document.querySelector('.empty-hero') !== null;
        sTitle.textContent = isEmptyView ? t.sub0 : t.sub1;
      }
      bHome.textContent  = t.home;
      bBack.textContent  = t.back;
      bLang.textContent  = t.langToggle;
      document.querySelectorAll('[data-role="select"]').forEach(btn=> btn.textContent = t.select);
      if(labelCS) labelCS.textContent = t.cs;
      if(labelOffice) labelOffice.textContent = t.office;
      if(btnInter) btnInter.textContent = t.inter;
      if(helpMsg) helpMsg.textContent = t.help;
    }

    if(bLang){ bLang.onclick = ()=>{ lang=(lang==='ja'?'en':'ja'); localStorage.setItem('kiosk_lang',lang); applyLang(); }; }
    if(btnInter){ btnInter.onclick = ()=>{ window.location.href = '/kiosk/interphone'; }; }

    applyLang();
  })();
  </script>
</body>
</html>
